<% if current_user.admin %>
  <%= title "Listing Sensors" do -%>
    <% if current_user.admin %>
      <%= render :partial => 'sensors/add' %>
      <%= render :partial => 'settings/menu' %>
    <% end %>
  <%- end -%>
<% else %>
  <%= title "Listing Sensors" -%>
<% end %>

<%= stylesheet_link_tag "jquery.treeTable" %>
<%= javascript_include_tag "jquery.treeTable" %>
<%= javascript_include_tag "jquery.ui.draggable" %>
<%= javascript_include_tag "jquery.ui.droppable" %>
<%= javascript_include_tag "jquery.ui.core.js" %>
<%= javascript_include_tag "jquery.ui.mouse.js" %>
<%= javascript_include_tag "jquery.ui.widget.js" %>

<div id="sensors" class='boxit'>
  <table id="sensorTable" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <th>Name</th>
      <th>Hostname</th>
      <th>Interface</th>
      <th>Ip</th>
      <th>Last Event</th>
      <th>Event Count</th>
      <th>Event %</th>
      <th></th>
      <th></th>
    </tr>
    <tbody class='sensors'>
      <%= render :partial => 'sensors/sensor', :locals => {:sensor=> Sensor.root} %>
      <%= render @sensors %>
    </tbody>
  </table>

</div>

<script type="text/javascript">
  window.onload=function(){
    $('table#sensorTable tbody.sensors #sensor_1').toggleBranch()
    var elements = $('table#sensorTable tbody.sensors').children('.folder').not('.ui-helper-hidden').not("#sensor_1");
    for (var i = 0; i < elements.length; i++){
      $(elements[i]).toggleBranch();
    }
  }  
</script>